<%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="ui" uri="http://egovframework.gov/ctl/ui" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>
<%@ taglib prefix="validator" uri="http://www.springmodules.org/tags/commons-validator" %>
<%@ taglib prefix="lw" uri="/WEB-INF/tld/lw.tld" %>
<%
/**
 * @Class Name : paymentHistoryList.jsp
 * @Description : 회비납부현황을 조회하는 페이지
 * @Modification Information
 *
 * @ 수정일      수정자     수정내용
 * @ ----------  ---------  -------------------------------
 * @ 2012.12.27  송제승     최초생성
 *
 * @author 송제승
 * @since 2012.12.27
 * @version 1.0
 * @see
 *
 * Copyright (C) 2012 by Sinsuldong All right reserved.
 */
%>
<lw:cacheable/>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Language" content="utf-8" >
<title>납부관리 - 회비납부현황</title>
<jsp:include page="/WEB-INF/jsp/common/header.jsp" flush="true" />
<script type="text/javaScript" language="javascript" defer="defer">
<!--
//날짜초기값셋팅
$(document).ready(function() {
	var formObj = $("#moneyVO");
	$("#startDate").val('<c:out value="${moneyVO.startDate}"/>');
	$("#endDate").val('<c:out value="${moneyVO.endDate}"/>');
	return;
});

/* pagination 페이지 링크 function */
function fn_retrievePaymentHistoryList(pageNo){
	var frm = $("#moneyVO");

	$("#pageIndex").val(pageNo);

	frm.attr("action", "<c:url value='/payment/retrievePaymentHistoryList.do'/>");
	frm.submit();
}

//갯수별로 보기
function fn_recordCountPerPage() {
	fn_retrievePaymentHistoryList("1");
}

/* 엑셀 다운로드 */
function fn_paymentHistoryExcelDown(){
	var frm = $('#moneyVO') ;
	
	frm.attr("action", "<c:url value='/payment/paymentHistoryExcelDown.do'/>");
	frm.submit();
}
-->
</script>
</head>
<body>
<!-- 전체 레이어 시작 -->
<div id="wrap">
    <lw:header/>
    <!-- container 시작 -->
    <div id="container">
        <!-- 좌측메뉴 시작 -->
        <div id="leftmenu">
			<div id="nav"><lw:menuList /></div>
		</div>
        <!-- //좌측메뉴 끝 -->	
		<!-- content 시작 -->			
		<div id="content">
			<!-- 현재위치 네비게이션 시작 -->
			<!-- 타이틀 -->
			<lw:title2 type="type1" params="납부관리|회비납부현황" delim="|"/>
			<!-- //현재위치 네비게이션 끝 -->
			<!-- 타이틀 이미지 -->			
			<div id="content_img_div"><img src="/static/images/subtitle/img_subtitle03-02.gif" width="776" height="230" /></div>
			<!-- main content 시작 -->
			<div class="content_field"><h2>회비납부현황</h2></div>
			<!-- //main content 끝 -->		
			<form:form commandName="moneyVO" method="post">
			<!-- 검색 필드 박스 시작 -->				 
			<div id="search_field">
			  	<fieldset><legend>조건정보 영역</legend>	  
			  		<ul id="search_first_ul">
			  			<lw:calendarTag2 />
			  			<li>
		  				    <div class="buttons" style="float:left;padding-left:2px;">
							<a href="#" onclick="javascript:fn_retrievePaymentHistoryList(1);"><img src="/static/images/img_search.gif" alt="search" />검색 </a>
							</div>	  		
			  			</li>	
			  		</ul>
			  	</fieldset>
			</div> 
			<!-- //검색 필드 박스 끝 -->
			<div id="page_info">
				<div id="page_info_align">
					[ <span class="orenge_s">총 <c:out value="${paginationInfo.totalRecordCount}"/> 건</span> (<c:out value="${paginationInfo.currentPageNo}"/> / <c:out value="${paginationInfo.totalPageCount}"/> page) ]
					<a href='#' onclick="fn_paymentHistoryExcelDown();">엑셀다운로드</a>
					<form:select path="recordCountPerPage" cssClass="use" onchange="fn_recordCountPerPage()">
						<form:option value="10" label="10개씩 보기" />
						<form:option value="20" label="20개씩 보기" />
						<form:option value="30" label="30개씩 보기" />
						<form:option value="40" label="40개씩 보기" />
						<form:option value="50" label="50개씩 보기" />
					</form:select>
				</div>
			</div>		
			<!-- table add start -->
			<div class="default_tablestyle">
				<!-- List -->
				<table width="100%" border="0" cellpadding="0" cellspacing="0">
					<colgroup>
						<col width="20">
						<col width="140">
						<col width="80">
						<col width="80">
						<col width="80">
						<col width="120">
					</colgroup>
					<tr>
						<th align="center">No</th>
						<th align="center">거래일시</th>
						<th align="center">출금액</th>
						<th align="center">입금액</th>
						<th align="center">잔액</th>
						<th align="center">거래내용</th>
					</tr>
					<c:set var="seq" value="${paginationInfo.totalRecordCount - ((paginationInfo.currentPageNo - 1) * paginationInfo.recordCountPerPage)}"/>
					<c:forEach var="result" items="${resultList}" varStatus="status">
					<tr>
						<td align="center" class="listtd"><c:out value="${seq}"/></td>
						<td align="center" class="listtd"><c:out value="${result.moneyTradedt}"/></td>
						<td align="center" class="listtd"><c:out value="${result.moneyWithdraw}"/>&nbsp;</td>
						<td align="center" class="listtd"><c:out value="${result.moneyDeposit}"/>&nbsp;</td>
						<td align="center" class="listtd"><c:out value="${result.moneyBalance}"/>&nbsp;</td>
						<td align="center" class="listtd"><c:out value="${result.moneyDesc}"/>&nbsp;</td>
					</tr>
					<c:set var="seq" value="${seq-1}"/>
					</c:forEach>
				</table>
				<!-- /List -->
			</div>		
			<div id="paging">
				<ul class="paging_align">
				<ui:pagination paginationInfo="${paginationInfo}" type="image" jsFunction="fn_retrievePaymentHistoryList" />
				<form:hidden path="pageIndex" />
				</ul>
			</div>	
			</form:form>
		</div>
	</div>
	<!-- //container 끝 -->
	<!-- footer 시작 -->
	<div id="footer">
	</div>
	<!-- //footer 끝 -->				
</div>
<!-- //전체 레이어 끝 -->
</body>
</html>